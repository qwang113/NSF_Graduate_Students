---
title: "One Step Ahead MSE"
author: "Qi"
date: "2023-09-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(tscount)
nsf_dat <- read.csv("D:/77/UCSC/study/Research/temp/NSF_dat/nsf_final.csv", header = TRUE)
```


```{r}
uni_id <- unique(nsf_dat$ID)
model_order <- rep(NA, length(uni_id))

for (i in 1: length(uni_id)) {
  
  print(paste("Now doing index ", i, "among",length(uni_id)))
  
  for (j in 1:10) {
      curr_AIC <- rep(NA, 10)
      model_temp <- tsglm(ts = nsf_dat$y[which(nsf_dat$ID==uni_id[i])], link = "log", distr = "poisson", model = list(past_obs = 1:j))
      curr_AIC[j] <- summary(model_temp)$AIC
  }
  
  model_order[i] <- which.min(curr_AIC)


}


# predict(model_1, n.ahead = 12)


```

